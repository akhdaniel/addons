<?xml version="1.0"?>
<openerp>
    <data>

        <record model="ir.ui.view" id="product_custom_order_line">
            <field name="name">Product Custom DJI SLU</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <form string="Sales Order" position="replace">
                <form string="Sales Order" version="7.0">
                    <header>
                        <button
                        name="compute_discount"
                        string="Sent"
                        type="object" states="draft"
                        class="oe_highlight" groups="base.group_sale_salesman_all_leads,base.group_sale_manager"/>  

                        <button
                        name="reset_discount"
                        string="Reset to Draft"
                        type="object" states="sent" groups="base.group_sale_salesman_all_leads,base.group_sale_manager"/> 

                        <button name="invoice_recreate" states="invoice_except" string="Recreate Invoice" groups="base.group_sale_salesman_all_leads,base.group_sale_manager"/>

                        <button name="invoice_corrected" states="invoice_except" string="Ignore Exception" groups="base.group_sale_salesman_all_leads,base.group_sale_manager"/>
                        <button name="action_quotation_send" string="Send by Email" type="object" states="draft" class="oe_highlight" groups="base.group_sale_salesman_all_leads,base.group_sale_manager"/>

                        <button name="action_quotation_send" string="Send by Email" type="object" states="sent" groups="base.group_sale_salesman_all_leads,base.group_sale_manager"/>

                        <button name="print_quotation" string="Print" type="object" states="draft" class="oe_highlight" groups="base.group_sale_salesman_all_leads,base.group_sale_manager" invisible="1"/>

                        <button name="print_quotation" string="Print" type="object" states="sent" groups="base.group_sale_salesman_all_leads,base.group_sale_manager" invisible="1"/>

                        <button name="action_button_confirm" states="sent" string="Confirm Sale" class="oe_highlight" type="object" groups="base.group_sale_salesman_all_leads,base.group_sale_manager"/>

                        <button name="action_view_invoice" string="View Invoice" type="object" class="oe_highlight" attrs="{'invisible': [('invoice_exists', '=', False)]}" groups="base.group_sale_salesman_all_leads,base.group_sale_manager"/>

                        <button name="477" string="Create Invoice" type="action" states="manual" class="oe_highlight" groups="base.group_sale_salesman_all_leads,base.group_sale_manager"/>

                        <button name="copy_quotation" states="cancel" string="New Copy of Quotation" type="object" groups="base.group_sale_manager" invisible="1"/>

                        <button name="cancel" states="draft,sent" string="Cancel Quotation" groups="base.group_sale_salesman_all_leads,base.group_sale_manager"/>

                        <button name="action_cancel" states="manual,progress" string="Cancel Order" type="object" groups="base.group_sale_salesman_all_leads,base.group_sale_manager" invisible="1"/>

                        <button name="invoice_cancel" states="invoice_except" string="Cancel Order" groups="base.group_sale_salesman_all_leads,base.group_sale_manager" invisible="1"/>

                        <field name="state" widget="statusbar" statusbar_visible="draft,sent,invoiced,done" statusbar_colors="{&quot;invoice_except&quot;:&quot;red&quot;,&quot;waiting_date&quot;:&quot;blue&quot;}"/>
                    
                </header>

                    <h1>
                        <label string="Draft SO " attrs="{'invisible': [('state','not in',('draft','sent'))]}"/>
                        <label string="Sales Order " attrs="{'invisible': [('state','in',('draft','sent'))]}"/>
                        <div>
                        <field name="loc_code" class="oe_inline" attrs="{'invisible': [('state','!=','draft')]}"/>    
                        <field name="name" class="oe_inline" readonly="1"/>
                        </div>
                    </h1>
                    <group>
                        <group>
                            <field name="partner_code" string="Code"/>
                            <field name="partner_id" on_change="onchange_partner_id(partner_id, context)" domain="[('customer','=',True)]" context="{'search_default_customer':1, 'show_address': 1}" options="{&quot;always_reload&quot;: True}" attrs="{'readonly': [('state','!=','draft')]}"/>
                            <field name="partner_id2" attrs="{'readonly': [('state','!=','draft')]}"/>
                            <field name="partner_invoice_id" groups="sale.group_delivery_invoice_address" context="{'default_type':'invoice'}"/>
                            <field name="partner_shipping_id" groups="sale.group_delivery_invoice_address" context="{'default_type':'delivery'}"/>
                            <field name="project_id" context="{'partner_id':partner_invoice_id, 'default_pricelist_id':pricelist_id, 'default_name':name, 'default_type': 'contract'}" groups="sale.group_analytic_accounting" domain="[('type','in',['view','normal','contract'])]"/>
                        </group>
                        <group>
                            <field name="date_order"/>
                            <field name="client_order_ref"/>
                            <field name="location_id" />
                            <field domain="[('type','=','sale')]" name="pricelist_id" groups="product.group_sale_pricelist" on_change="onchange_pricelist_id(pricelist_id,order_line)" invisible="True"/>
                            <field name="currency_id" invisible="1"/>
                        </group>                          
                        <group invisible="True">
                            <field name="shop_id" groups="base.group_no_one" on_change="onchange_shop_id(shop_id, context)" widget="selection" invisible="True"/>
                        </group>                      
                    </group>
                    <notebook>
                        <page string="Order Lines" invisible="0">
                            <field name="order_line" view_mode="form,tree" attrs="{'readonly': [('state','!=','draft')]}">
                                <form string="Sales Order Lines" version="7.0">

                                    <group colspan="2">
                                        <group>
                                            <field name="state" invisible="1"/>
                                            <field name="coeff" invisible="1"/>
                                            <field name="product_id" context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}" groups="base.group_user" on_change="product_id_change(parent.pricelist_id, product_id, product_uom_qty, product_uom, product_uos_qty, product_uos, name, parent.partner_id, False, True, parent.date_order, False, parent.fiscal_position, False, context)" attrs="{'readonly': [('state','!=','draft')]}" domain="[('bonus','=', False)]"/>
                                            <label for="product_uos_qty" groups="product.group_uos" string="Big Qty"/>
                                            <div groups="product.group_uos">
                                                <field name="product_uos_qty" class="oe_inline" on_change="onchange_uos(coeff,product_uos_qty)" invisible="True"/>
                                                <field name="qty_big"/> 
                                                <field name="product_uos" invisible="True"/>
                                            </div>                                            
                                            <label for="product_uom_qty" string="Small Qty"/>
                                            <div>
                                                <field context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}" name="product_uom_qty" class="oe_inline" on_change="product_id_change(parent.pricelist_id,product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name,parent.partner_id, False, False, parent.date_order, False, parent.fiscal_position, True, context)" string="Small Qty" invisible="True"/>
                                                <field name="qty_small"/>
                                                <field name="product_uom" groups="product.group_uom" class="oe_inline oe_no_button" on_change="product_uom_change(parent.pricelist_id,product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name,parent.partner_id, False, False, parent.date_order, context)" invisible="1"/>
                                            </div>
                                        
                                                                                     
                                            <field name="gross_tot" invisible="1"/>
                                            <field name="price_unit" invisible="1"/>
                                            <label for="discount" groups="sale.group_discount_per_so_line"/>
                                            <div name="discount" groups="sale.group_discount_per_so_line">
                                                <field name="disc_value" class="oe_inline" invisible="1"/>
                                                <field name="discount" class="oe_inline" invisible="1"/>
                                            </div>
                                            <field name="th_weight" invisible="1"/>
                                            <field name="volume" invisible="1"/>
                                        </group>
                                        <group>
                                            <field name="name" attrs="{'readonly': [('state','!=','draft')]}" invisible="True"/>
                                        </group>                                            
                                        <group invisible="1">
                                            <field name="tax_id" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','&lt;&gt;','purchase')]" invisible="1"/>
                                            <field name="type" invisible="1"/>

                                            <field name="address_allotment_id" invisible="1"/>
                                        </group>
                                    </group>
                                    <div groups="base.group_no_one" invisible="1">
                                        <label for="invoice_lines" />
                                        <field name="invoice_lines" />
                                    </div>
                                </form>
                                <tree string="Sales Order Lines" editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="state" invisible="1"/>
                                    <field name="th_weight" invisible="1"/>
                                    <field name="coeff" invisible="True"/>
                                    <field name="product_id" context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}" groups="base.group_user" on_change="product_id_change(parent.pricelist_id, product_id, product_uom_qty, product_uom, product_uos_qty, product_uos, name, parent.partner_id, False, True, parent.date_order, False, parent.fiscal_position, False, context)"  domain="[('bonus','=', False)]" invisible="1"/>
                                    <field name="name" attrs="{'readonly': [('state','!=','draft')]}"/>
                                    <field name="volume" invisible="1"/>

                                    <field name="product_uos_qty" groups="product.group_uos" on_change="onchange_uos(coeff,product_uos_qty)" string="Big Qty" invisible="1"/>
                                    <field name="qty_big"/>    
                                    <field name="product_uos" groups="product.group_uos" string="Big UoM"/>
                                    <field name="uos2" readonly="True" invisible="True"/>
                                    <field name="qty_small"/>
                                    <field name="product_uom_qty" context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}" on_change="product_id_change(parent.pricelist_id, product_id, product_uom_qty, product_uom, product_uos_qty, product_uos, name, parent.partner_id, False, False, parent.date_order, False, parent.fiscal_position, True, context)" string="Small Qty" invisible="1"/>
                                    <field name="product_uom" on_change="product_uom_change(parent.pricelist_id, product_id, product_uom_qty, product_uom, product_uos_qty, product_uos, name, parent.partner_id, False, False, parent.date_order, context)" groups="product.group_uom" options="{&quot;no_open&quot;: True}" string="Small UoM"/>                                   
                                    <field name="tax_id" groups="base.group_sale_salesman_all_leads" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','&lt;&gt;','purchase')]" invisible="1"/>                                   
                                    <field name="price_unit" readonly="False" />
                                    <field name="gross_tot" invisible="1"/>
                                    <field name="disc_value"/>
                                    <field name="discount" groups="sale.group_discount_per_so_line,base.group_sale_salesman_all_leads"/>
                                    <field name="r_flat" invisible="1"/> 

                                    <field name="p_disc_value"/>
                                    <field name="p_disc_pre"/>
                                    <field name="p_flat" invisible="1"/> 

                                    <field name="p_disc_value_x"/>
                                    <field name="p_disc_pre_x"/> 
                                    <field name="x_flat" invisible="1"/>

                                    <field name="p_disc_value_c"/>
                                    <field name="p_disc_pre_c"/> 
                                    <field name="c_flat" invisible="1"/>

                                    <field name="p_disc_value_m"/>
                                    <field name="p_disc_pre_m"/> 
                                    <field name="m_flat" invisible="1"/>
                                    <field name="price_subtotal"/>
                                   <!--  <field name="tes"/> -->
                                </tree>    
                            </field>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="sale_total">
                                <field name="amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <field name="amount_tax" widget="monetary" options="{'currency_field': 'currency_id'}"/>

                                <div class="oe_subtotal_footer_separator oe_inline">
                                    <label for="amount_total"/>
                                    <button name="button_dummy" states="draft,sent" string="(update)" type="object" class="oe_edit_only oe_link"/>
                                </div>
                                <field name="amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                            </group>
                            <group colspan="2">
                                <field name="credit"/>
                                <field name="credit_limit"/>
                            </group>                              
                            <div class="oe_clear"/>
                            <field name="note" class="oe_inline" placeholder="Terms and conditions..."/>
                        </page>
                        <page string="Other Information" groups="base.group_user">
                            <group>
                                <!-- <field name="picking_policy"/> -->
                                <group name="sales_person" groups="base.group_user">
                                    <field name="nik"/>
                                    <field name="user_id" readonly="True" string="Salesman"/>
                                    <field groups="base.group_no_one" name="origin"/>
                                </group>
                                <group name="sale_pay">
                                    <field name="payment_term" widget="selection" invisible="True"/>
                                    <field name="due_date" invisible="0"/>
                                    <field name="fiscal_position" widget="selection" invisible="True"/>
                                    <field name="property_payment_term"/>
                                    <field name="volume_tot"/>
                                    <field name="company_id" widget="selection" groups="base.group_multi_company" invisible="False"/>
                                </group>
                                <group>
                                    <field name="invoiced"/>
                                    <field name="invoice_exists" invisible="1"/>
                                    
                                </group>
                            </group>
                        </page>
                    </notebook>

                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                </form>
            </form>

            </field>
        </record>


<!-- Cust Invoice -->

        <record model="ir.ui.view" id="view_invo_tree">
            <field name="name">Invoice Tree Custom DJI SLU</field>
            <field name="model">account.invoice</field>
            <field name="inherit_id" ref="account.invoice_tree"/>
            <field name="arch" type="xml">
                <field name="state" position="before">
                    <field name="volume" sum="Residual Amount"/>
                    <field name="based_route_id" invisible="True"/>
                </field>                    
            </field>
        </record>

        <record model="ir.ui.view" id="custom_invoice">
            <field name="name">Invoice Custom DJI SLU</field>
            <field name="model">account.invoice</field>
            <field name="inherit_id" ref="account.invoice_form"/>
            <field name="arch" type="xml">

            <header position="replace">
                <header>
                    <button name="action_invoice_sent" type="object" string="Send by Email" attrs="{'invisible':['|',('sent','=',True), ('state', '!=', 'open')]}" class="oe_highlight" groups="base.group_user"/>
                    <button name="invoice_print" string="Print" type="object" attrs="{'invisible':['|',('sent','=',True), ('state', '!=', 'open')]}" class="oe_highlight" groups="base.group_user"/>
                    <button name="action_invoice_sent" type="object" string="Send by Email" attrs="{'invisible':['|',('sent','=',False), ('state', '!=', 'open')]}" groups="base.group_user"/>
                    <button name="invoice_print" string="Print Invoice" type="object" attrs="{'invisible':['|',('sent','=',False), ('state', '!=', 'open')]}" groups="base.group_user"/>
                    <button name="invoice_open" states="draft,deliver,cn_conf" string="Validate" class="oe_highlight" groups="base.group_user"/>

                   <!--  <button name="invoice_open" states="deliver" string="CN Confirmation" class="oe_highlight" groups="base.group_user"/> -->
                    <button name="action_deliver" states="draft" string="Deliver" type="object" class="oe_highlight" groups="base.group_user"/>
                    <button name="invoice_cancel" states="deliver,cn_conf,open" string="Cancel Invoice" groups="base.group_user"/>
                    <button name="invoice_open" states="proforma2" string="Validate" groups="base.group_user"/>

                    <button name="invoice_proforma2" states="draft" string="PRO-FORMA" groups="account.group_proforma_invoices"/>
                    <button name="258" type="action" string="Refund Invoice" states="open,proforma2,paid" groups="base.group_user"/>
                    <!--button name="invoice_cancel" states="draft,deliver,open" string="Cancel Invoice" groups="base.group_no_one"/-->
                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
                    <button name="272" type="action" string="Re-Open" groups="account.group_account_invoice" attrs="{'invisible':['|', ('state','&lt;&gt;','paid'), ('reconciled', '=', True)]}" help="This button only appears when the state of the invoice is 'paid' (showing that it has been fully reconciled) and auto-computed boolean 'reconciled' is False (depicting that it's not the case anymore). In other words, the invoice has been dereconciled and it does not fit anymore the 'paid' state. You should press this button to re-open it and let it continue its normal process after having resolved the eventual exceptions it may have created."/>
                    <!--button name="253" string="Print Invoice" type="action" states="open,paid,proforma,sale,proforma2"/-->
                    <field name="state" widget="statusbar" nolabel="1" statusbar_visible="draft,open,paid" statusbar_colors="{&quot;proforma&quot;:&quot;blue&quot;,&quot;proforma2&quot;:&quot;blue&quot;}"/>
                </header>            
            </header>    
                <field name="user_id" position="before">
                        <field name="nik"/>
                </field>                 
                <field name="user_id" position="after">
                        <field name="location_id"/>
                        <field name="based_route_id"/>
                </field>   
                <field name="move_id" position="after">
                    <field name="user_id2"/>
                    <field name="location_id2"/>                     
                </field>     
                <field name="tax_line" position="before">
                    <group>
                        <group>
                            <field name="credit"/>
                            <field name="credit_limit"/>
                        </group>
                         <group>
                            <field name="volume"/>
                            <field name="weight"/>
                        </group>    
                    </group>                      
                </field>
                    <page string="Invoice Lines" position="replace">
                        <page string="Invoice Lines">
                            <field name="invoice_line" nolabel="1" widget="one2many_list" context="{'type': type}">
                                <tree string="Invoice Lines" editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="product_id" on_change="product_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.currency_id, context, parent.company_id)"/>
                                    <field name="name"/>
                                    <field name="company_id" invisible="1"/>
                                    <field name="account_id" groups="account.group_account_user" domain="[('company_id', '=', parent.company_id), ('journal_id', '=', parent.journal_id), ('type', '=', 'other')]" on_change="onchange_account_id(product_id, parent.partner_id, parent.type, parent.fiscal_position,account_id)"/>
                                    <field name="account_analytic_id" groups="analytic.group_analytic_accounting" domain="[('type','!=','view'), ('company_id', '=', parent.company_id)]" invisible="1"/>
                                    <field name="qty" string="Big Qty"/>
                                    <field name="uos_id" groups="product.group_uom" on_change="uos_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.currency_id, context, parent.company_id)" string="Big UoM"/>
                                    <field name="quantity2"/>
                                    <field name="uom_id"/>
                                    <field name="price_unit"/>
                                    <field name="discount" groups="sale.group_discount_per_so_line"/>
                                    <field name="invoice_line_tax_id" widget="many2many_tags" context="{'type':parent.type}" domain="[('parent_id','=',False),('company_id', '=', parent.company_id)]"/>
                                    <field name="quantity" invisible="1"/>
                                    <field name="qty_func" invisible="1"/>
                                    <field name="disc_tot" invisible="1"/>
                                    <field name="price_subtotal"/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right">
                                <field name="amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <div>
                                    <label for="amount_tax"/>
                                    <button name="button_reset_taxes" states="draft,proforma2" string="(update)" class="oe_link oe_edit_only" type="object" help="Recompute taxes and total"/>
                                </div>
                                <field name="amount_tax" nolabel="1" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <field name="amount_total" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <field name="residual" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <field name="reconciled" invisible="1"/>
                            </group>
                            <group>
                                    <field name="payment_term" class="oe_inline"/>
                            </group>
                            <div class="oe_clear">
                                <label for="comment"/>
                            </div>
                            <field name="comment" class="oe_inline" placeholder="Additional notes..."/>
                        </page>
                    </page>    

            </field>
        </record>        


<!-- Supplier Inv -->
        <record model="ir.ui.view" id="custom_invoice_supp">
            <field name="name">Invoice Custom DJI SLU</field>
            <field name="model">account.invoice</field>
            <field name="inherit_id" ref="account.invoice_supplier_form"/>
            <field name="arch" type="xml">

                <header position="replace">
                    <header>
                        <button name="invoice_open" states="draft,proforma2,cn_conf,deliver" string="Validate" class="oe_highlight" groups="account.group_account_invoice"/>
<!--                         <button name="invoice_open" states="draft,proforma2,cn_conf,deliver" string="CN Confirmation" class="oe_highlight" groups="account.group_account_invoice"/> -->
                        <button name="invoice_cancel" states="draft,proforma2,cn_conf,deliver" string="Cancel Invoice" class="oe_highlight" groups="account.group_account_invoice"/>
                        <button name="258" type="action" string="CN Confirmation" states="open,paid" groups="account.group_account_invoice"/>
                        <button name="invoice_cancel" states="draft,proforma2,cn_conf,deliver" string="Cancel Invoice" groups="account.group_account_invoice"/>
                        <button name="action_cancel_draft" states="cancel" string="Set to Draft" type="object" groups="account.group_account_invoice"/>
                        <button name="272" type="action" string="Re-Open" groups="account.group_account_invoice" attrs="{'invisible':['|', ('state','&lt;&gt;','paid'), ('reconciled', '=', True)]}" help="This button only appears when the state of the invoice is 'paid' (showing that it has been fully reconciled) and auto-computed boolean 'reconciled' is False (depicting that it's not the case anymore). In other words, the invoice has been dereconciled and it does not fit anymore the 'paid' state. You should press this button to re-open it and let it continue its normal process after having resolved the eventual exceptions it may have created."/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,open,paid" statusbar_colors="{&quot;proforma&quot;:&quot;blue&quot;,&quot;proforma2&quot;:&quot;blue&quot;}"/>
                    </header> 
                </header>
            </field>
        </record> 
<!-- location -->
        <record model="ir.ui.view" id="custom_location">
            <field name="name">Invoice Custom DJI SLU</field>
            <field name="model">stock.location</field>
            <field name="inherit_id" ref="stock.view_location_form"/>
            <field name="arch" type="xml">
                <label for="name" position="before">
                    <group colspan="2">
                        <field name="code"/>
                    </group>    
                </label>

            </field>
        </record>  

    </data>
</openerp>