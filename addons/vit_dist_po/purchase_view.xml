<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="seq_create_po" model="ir.sequence.type">
            <field name="name">NoBukti</field>
            <field name="code">purchase.order.seq</field>
        </record>
        <record id="seq_c_po" model="ir.sequence">
            <field name="name">NoBukti</field>
            <field name="code">purchase.order.seq</field>
            <field name="prefix"></field>
            <field name="padding">7</field>
            <field name="company_id" eval="False"/>
        </record>

        <record id="purchase_order_form_custom" model="ir.ui.view">
            <field name="name">purchase.order.form.custom</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_form"/>
            <field name="arch" type="xml">
                <form string="Purchase Order" version="7.0" position="replace">
                    <form string="Purchase Order" version="7.0">
                        <header>
                            <button name="wkf_send_rfq" states="draft" string="Send by Email" type="object" context="{'send_rfq':True}" class="oe_highlight"/>
                            <button name="wkf_send_rfq" states="sent" string="Send by Email" type="object" context="{'send_rfq':True}"/>
                            <button name="print_quotation" string="Print" type="object" states="draft" class="oe_highlight" groups="base.group_user"/>
                            <button name="print_quotation" string="Print" type="object" states="sent" groups="base.group_user"/>
                            <button name="purchase_confirm" states="draft" string="Confirm Order"/>
                            <button name="purchase_confirm" states="sent" string="Confirm Order" class="oe_highlight"/>
                            <button name="wkf_send_rfq" states="confirmed" string="Resend Purchase Order" type="object" class="oe_highlight"/>
                            <button name="action_cancel" states="approved,except_picking,except_invoice" string="Cancel Order" type="object" />
                            <button name="picking_ok" states="except_picking" string="Manually Corrected"/>
                            <button name="invoice_ok" states="except_invoice" string="Manually Corrected"/>
                            <button name="purchase_approve" states="confirmed" string="Approve Order" class="oe_highlight" groups="purchase.group_purchase_manager"/>
                            <button name="view_picking" string="Receive Products" type="object" attrs="{'invisible': ['|', ('shipped','=',True), ('state','!=', 'approved')]}" class="oe_highlight"/>
                            <button name="view_invoice" string="Receive Invoice" type="object" attrs="{'invisible': ['|', ('invoice_method','=','picking'), '|', ('state','!=', 'approved'), ('invoiced','=',True) ]}" class="oe_highlight"/>
                            <button name="action_cancel_draft" states="cancel,sent,confirmed" string="Set to Draft" type="object" />
                            <button name="purchase_cancel" states="draft,confirmed,sent" string="Cancel Order"/>
                            <field name="state" widget="statusbar" statusbar_visible="draft,sent,approved,done" statusbar_colors='{"except_picking":"red","except_invoice":"red","confirmed":"blue"}' readonly="1"/>
                        </header>
                        <div class="oe_title">
                            <h1>
                                <label string="Request for Quotation " attrs="{'invisible': [('state','not in',('draft','sent'))]}"/>
                                <label string="Purchase Order " attrs="{'invisible': [('state','in',('draft','sent'))]}"/>
                                <field name="name" class="oe_inline" readonly="1"/>
                            </h1>
                        </div>
                        <group >
                            <group> 
                                    <field name="partner_x" on_change="onchange_partner_x(partner_x,date_order)"/>
                                    <field name="loc_x" on_change="onchange_locx(loc_x,location_id)" groups="stock.group_locations"/>
                                    <field name="partner_id" class="oe_inline" invisible="True"/>
                                    <field name="location_id" groups="stock.group_locations" invisible="True"/>
                                    <field name="partner_ref"/>
                                    <field domain="[('type','=','purchase')]" name="pricelist_id" groups="product.group_purchase_pricelist" on_change="onchange_pricelist(pricelist_id, context)"/>
                                    <field name="currency_id" invisible='1'/>
                                    <field name="journal_id" invisible='1'/>
                                    <field name="date_order" attrs="{'readonly': True }"/>
                                    <!-- <field name='periode'/> -->
                            </group>
                            <group>
                                <field name="origin" attrs="{'invisible': [('origin','=',False)]}"/>
                                <field name="warehouse_id" attrs="{'invisible':True}" on_change="onchange_warehouse_id(warehouse_id)" widget="selection" groups="stock.group_locations"/>
                                <field name="company_id" groups="base.group_multi_company" widget="selection"/>
                            </group>
                        </group>

                        <separator string="Week 1"/>
                        <label for='view_w1'/><field name='view_w1'/>
                        <group attrs="{'invisible':[('view_w1', '=', False)]}">
                            <group col="7">
                                <label for="r1"/>
                                <label for="r1e"/>
                                <label for="percent_r1"/>
                                <label for="qr1" invisible="1"/>
                                <label for="volume_r1"/>
                                <label for="weight_r1"/>
                                <!-- <label for="fleet_id"/> -->
                                <label for="no_vehicle"/>
                                <div><field name='r1' required="1"/></div>
                                <div><field name='r1e' required="1"/></div>
                                <div><field name='percent_r1' on_change="onchange_rx(percent_r1,'1',percent_r1,percent_r2,percent_r3,percent_r4,sch_ids1,r1, order_line,qr1,volume_r1,weight_r1)"/></div>
                                <div invisible="1"><field name='qr1'/></div>
                                <div><field name='volume_r1'/></div>
                                <div><field name='weight_r1'/></div>
                                <div><field name='no_vehicle' /></div>
                            </group>
                            <group/>
                            <group>
                                <div >
                                    <field name="sch_ids1" view_mode="tree">
                                        <tree editable="button" colors="blue:'cukup' not in [moq_m3]"> <!-- bds kg, in [moq_kg] -->
                                            <field name="name" on_change="onchange_name(name, name1s, alias, parent.sch_ids1, parent.r1, parent.r1e)"/>
                                            <field name="name1s"/>
                                            <field name="alias"/>
                                            <field name="p1" on_change="onchange_percent(p1, alias, parent.percent_r1, parent.order_line)"/>
                                            <field name="vol1"/>
                                            <field name='wgt1'/>
                                            <field name="fleet_id" widget="many2many_tags" on_change="onchange_fleet(volume, fleet_id, tonase)" colspan='2'/>
                                            <field name='volume'/>
                                            <field name='tonase'/>
                                            <field name="moq_m3"/>
                                            <field name="moq_kg"/>
                                        </tree>
                                    </field>
                                </div>
                            </group>
                        </group>
                    
                        <group >
                            <group string="Total">
                                <field name="volume_tot" class="oe_subtotal_footer_separator"/>
                                <field name="weight_tot" class="oe_subtotal_footer_separator"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Purchase Order">
                                <field name="order_line" on_change="onchange_lines(volume_tot, weight_tot, order_line)">
                                    <tree string="Purchase Order Lines" editable="botom">
                                        <field name="int_code" string="Code" readonly="1"/>
                                        <field name="barcode" string="Barcode" readonly="1"/>
                                        <field name="product_id" on_change="onchange_product_id(parent.pricelist_id,product_id,0,product_uom,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,name,price_unit,context)" invisible="1"/>
                                        <field name="name" readonly="1"/>
                                        <field name="date_planned" readonly="1" invisible="1"/>
                                        <field name="company_id" groups="base.group_multi_company" widget="selection"/>
                                        <field name="account_analytic_id" groups="purchase.group_analytic_accounting" domain="[('type','not in',('view','template'))]"/>
                                        <field name="suggested_order" string="Suggest"/>                    
                                        <field name="adjustment" on_change="onchange_line(product_id, adjustment, suggested_order, product_uom, price_unit,parent.volume_tot,parent.weight_tot,stock_current,in_transit,sales_3m,stock_cover,prod_weight,prod_volume,forecastMT,forecastGT, bufMT, bufGT)"/>
                                        <field name="product_qty" on_change="onchange_product_id(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id,parent.date_order,parent.fiscal_position,date_planned,name,price_unit,context)"/>
                                        <field name="product_uom" string="Unit" groups="product.group_uom" on_change="onchange_product_uom(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,name,price_unit,context)" readonly="1"/>
                                        <field name="price_unit" readonly="0"/>
                                        <field name="taxes_id" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','!=','sale')]" invisible="1"/>
                                        <field name="price_subtotal"/>                
                                        <field name="prod_weight" />             
                                        <field name="prod_volume" />
                                        <field name="avgMT"  string="Average MT" readonly="1"/>
                                        <field name="avgGT" string="Average GT" readonly="1"/>
                                        <field name="forecastMT" on_change="onchange_line(product_id, adjustment, suggested_order, product_uom, price_unit,parent.volume_tot,parent.weight_tot,stock_current,in_transit,sales_3m,stock_cover,prod_weight,prod_volume,forecastMT,forecastGT, bufMT, bufGT)"/>
                                        <field name="forecastGT" on_change="onchange_line(product_id, adjustment, suggested_order, product_uom, price_unit,parent.volume_tot,parent.weight_tot,stock_current,in_transit,sales_3m,stock_cover,prod_weight,prod_volume,forecastMT,forecastGT, bufMT, bufGT)"/>
                                        <field name="bufMT" readonly="1"/>
                                        <field name="bufGT" readonly="1"/>
                                        <field name="sales_3m" />   
                                        <field name="sales_3m2" invisible="1"/>                   
                                        <field name="stock_current" />                
                                        <field name="stock_current2" invisible="1"/>                  
                                        <field name="ending_inv" />                   
                                        <field name="ending_inv2" invisible="1"/>                 
                                        <field name="in_transit" />               
                                        <field name="in_transit2" invisible="1"/>                 
                                        <field name="stock_cover"/>                
                                        <field name="stock_cover2" invisible="1"/>
                                        <field name="w1" />      
                                        <field name="w11" invisible="context.get('w11',False)"/>
                                        <field name="w12" invisible="context.get('w12', False)"/>
                                        <field name="w13" invisible="context.get('w13', False)"/>
                                        <field name="w14" invisible="context.get('w14', False)"/>
                                        <field name="w15" invisible="context.get('w15', False)"/>
                                        <field name="w16" invisible="context.get('w16', False)"/>      
                                          
                                        <!-- <field name="qw14" />  
                                        <field name="W2" />                    
                                        <field name="W3" />                    
                                        <field name="W4" />     -->                   
                                    </tree>
                                </field>
                                <group class="oe_subtotal_footer oe_right">
                                    <field name="amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="amount_tax" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="amount_total"/>
                                        <button name="button_dummy"
                                            states="draft" string="(update)" type="object" class="oe_edit_only oe_link"/>
                                    </div>
                                    <field name="amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                                <div class="oe_clear"/>
                                <field name="notes" class="oe_inline" placeholder="Keterangan"/>
                            </page>
                            <page string="W1"  invisible="1">
                                <group col="12">
                                    <group>
                                        <!-- <field name="r1" string="From"/>
                                        <field string="to" name="r1e"/> -->
                                    </group>
                                    <group>
                                        <!-- <field name="percent_r1" on_change="onchange_percent(volume_tot ,weight_tot ,percent_r1,'1',percent_r1,percent_r2,percent_r3,percent_r4)" class="oe_subtotal_footer"/>
                                        <field name="volume_r1" class="oe_subtotal_footer oe_inline"/><field name="weight_r1" class="oe_subtotal_footer oe_inline"/> -->
                                    </group>
                                </group>
                                
                            </page>
                            <page string="W2" invisible="1">
                                <group col="6">
                                    <field name="r2" string="From"/><field string="to" name="r2e" class="oe_inline"/><newline/>
                                    <field name="percent_r2" on_change="onchange_percent(volume_tot ,weight_tot ,percent_r2,'2',percent_r1,percent_r2,percent_r3,percent_r4)" class="oe_subtotal_footer"/> <field name="volume_r2" class="oe_subtotal_footer oe_inline"/><field name="weight_r2" class="oe_subtotal_footer oe_inline"/>
                                </group>
                            </page>
                            <page string="W3" invisible="1">
                                <group col="6">
                                    <field name="r3" string="From"/><field string="to" name="r3e" class="oe_inline"/><newline/>
                                    <field name="percent_r3" on_change="onchange_percent(volume_tot ,weight_tot ,percent_r3,'3',percent_r1,percent_r2,percent_r3,percent_r4)" class="oe_subtotal_footer"/> <field name="volume_r3" class="oe_subtotal_footer oe_inline"/><field name="weight_r3" class="oe_subtotal_footer oe_inline"/>
                                </group>
                            </page>
                            <page string="W4" invisible="1">
                                <group col="6">
                                    <field name="r4" string="From"/><field string="to" name="r4e" class="oe_inline"/><newline/>
                                    <field name="percent_r4" on_change="onchange_percent(volume_tot ,weight_tot ,percent_r4,'4',percent_r1,percent_r2,percent_r3,percent_r4)" class="oe_subtotal_footer"/> <field name="volume_r4" class="oe_subtotal_footer oe_inline"/><field name="weight_r4" class="oe_subtotal_footer oe_inline"/>
                                </group>
                            </page>
                            <page string="User's Location">
                                <field name="location_ids" readonly="False"/>
                            </page>
                            <page string="User's Principals">
                                <field name="principal_ids" readonly="False" view_mode="tree">
                                    <tree editable="bottom">
                                        <field name='name'/>
                                        <field name='type_partner_id'/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Incoming Shipments &amp; Invoices">
                                <group>
                                    <group>
                                        <field name="dest_address_id" string="Customer Address" on_change="onchange_dest_address_id(dest_address_id)" groups="stock.group_locations"/>
                                        <field name="minimum_planned_date"/>
                                        <field name="shipped" groups="base.group_no_one"/>
                                    </group>
                                    <group>
                                        <field name="invoice_method"/>
                                        <field name="invoiced"/>
                                        <field name="payment_term_id" widget="selection"/>
                                        <field name="fiscal_position" attrs="{'readonly': [('invoiced','=', True)]}" />
                                        <field name="validator" groups="base.group_no_one"/>
                                        <field name="date_approve" groups="base.group_no_one"/>
                                    </group>
                                </group>
                            </page>
                        </notebook>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                    </form>
                </form>
            </field>
        </record>

    </data>
</openerp>
