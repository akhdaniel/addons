<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="seq_create_po" model="ir.sequence.type">
            <field name="name">NoBukti</field>
            <field name="code">purchase.order.seq</field>
        </record>
        <record id="seq_c_po" model="ir.sequence">
            <field name="name">NoBukti</field>
            <field name="code">purchase.order.seq</field>
            <field name="prefix"></field>
            <field name="padding">7</field>
            <field name="company_id" eval="False"/>
        </record>

        <record id="purchase_order_form_custom" model="ir.ui.view">
            <field name="name">purchase.order.form.custom</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_form"/>
            <field name="arch" type="xml">
                <form string="Purchase Order" version="7.0" position="replace">
                    <form string="Purchase Order" version="7.0">
                        <header>
                            <button name="wkf_send_rfq" states="draft" string="Send by Email" type="object" context="{'send_rfq':True}" class="oe_highlight"/>
                            <button name="wkf_send_rfq" states="sent" string="Send by Email" type="object" context="{'send_rfq':True}"/>
                            <button name="print_quotation" string="Print" type="object" states="draft" class="oe_highlight" groups="base.group_user"/>
                            <button name="print_quotation" string="Print" type="object" states="sent" groups="base.group_user"/>
                            <button name="purchase_confirm" states="draft" string="Confirm Order"/>
                            <button name="purchase_confirm" states="sent" string="Confirm Order" class="oe_highlight"/>
                            <button name="wkf_send_rfq" states="confirmed" string="Resend Purchase Order" type="object" class="oe_highlight"/>
                            <button name="action_cancel" states="approved,except_picking,except_invoice" string="Cancel Order" type="object" />
                            <button name="picking_ok" states="except_picking" string="Manually Corrected"/>
                            <button name="invoice_ok" states="except_invoice" string="Manually Corrected"/>
                            <button name="purchase_approve" states="confirmed" string="Approve Order" class="oe_highlight" groups="purchase.group_purchase_manager"/>
                            <button name="view_picking" string="Receive Products" type="object" attrs="{'invisible': ['|', ('shipped','=',True), ('state','!=', 'approved')]}" class="oe_highlight"/>
                            <button name="view_invoice" string="Receive Invoice" type="object" attrs="{'invisible': ['|', ('invoice_method','=','picking'), '|', ('state','!=', 'approved'), ('invoiced','=',True) ]}" class="oe_highlight"/>
                            <button name="action_cancel_draft" states="cancel,sent,confirmed" string="Set to Draft" type="object" />
                            <button name="purchase_cancel" states="draft,confirmed,sent" string="Cancel Order"/>
                            <field name="state" widget="statusbar" statusbar_visible="draft,sent,approved,done" statusbar_colors='{"except_picking":"red","except_invoice":"red","confirmed":"blue"}' readonly="1"/>
                        </header>
                        <div class="oe_title">
                            <h1>
                                <label string="Request for Quotation " attrs="{'invisible': [('state','not in',('draft','sent'))]}"/>
                                <label string="Purchase Order " attrs="{'invisible': [('state','in',('draft','sent'))]}"/>
                                <field name="name" class="oe_inline" readonly="1"/>
                            </h1>
                        </div>
                        <group >
                            <group> 
                                    <field name="partner_x" on_change="onchange_partner_x(partner_x,date_order)" options="{'create': False, 'create_edit': False}"/>
                                    <field name="loc_x" on_change="onchange_locx(loc_x,location_id)" groups="stock.group_locations" options="{'create': False, 'create_edit': False}"/>
                                    <field name="partner_id" class="oe_inline" invisible="True"/>
                                    <field name="location_id" groups="stock.group_locations" invisible="True"/>
                                    <field name="partner_ref"/>
                                    <field domain="[('type','=','purchase')]" name="pricelist_id" groups="product.group_purchase_pricelist" on_change="onchange_pricelist(pricelist_id, context)"/>
                                    <field name="currency_id" invisible='1'/>
                                    <field name="journal_id" invisible='1'/>
                                    <field name="date_order" attrs="{'readonly': True }"/>
                                    <!-- <field name='periode'/> -->
                            </group>
                            <group>
                                <field name="origin" attrs="{'invisible': [('origin','=',False)]}"/>
                                <field name="warehouse_id" attrs="{'invisible':True}" on_change="onchange_warehouse_id(warehouse_id)" widget="selection" groups="stock.group_locations"/>
                                <field name="company_id" groups="base.group_multi_company" widget="selection"/>
                            </group>
                        </group>

                        <separator string="Week 1"/>
                        <label for='view_w1'/><field name='view_w1'/>
                        <group attrs="{'invisible':[('view_w1', '=', False)]}">
                            <group col="7">
                                <label for="r1"/>
                                <label for="r1e"/>
                                <label for="percent_r1"/>
                                <label for="qr1" invisible="1"/>
                                <label for="volume_r1"/>
                                <label for="weight_r1"/>
                                <!-- <label for="fleet_id"/> -->
                                <label for="no_vehicle"/>
                                <div><field name='r1' /></div>
                                <div><field name='r1e' /></div>
                                <div><field name='percent_r1' on_change="onchange_rx(percent_r1,'1',percent_r1,percent_r2,percent_r3,percent_r4,sch_ids1, order_line,qr1,volume_r1,weight_r1)"/></div>
                                <div invisible="1"><field name='qr1'/></div>
                                <div><field name='volume_r1'/></div>
                                <div><field name='weight_r1'/></div>
                                <div><field name='no_vehicle' /></div>
                            </group>
                            <group/>
                            <group>
                                <div >
                                    <field name="sch_ids1" view_mode="tree">
                                        <tree editable="button" colors="blue:'cukup' not in [moq_m3]"> <!-- bds kg, in [moq_kg] -->
                                            <field name="name" on_change="onchange_name(name, name1s, alias, parent.sch_ids1, parent.r1, parent.r1e)"/>
                                            <field name="name1s"/>
                                            <field name="alias"/>
                                            <field name="p1" on_change="onchange_percent(p1, alias, parent.percent_r1, parent.order_line)"/>
                                            <field name="vol1"/>
                                            <field name='wgt1'/>
                                            <field name="fleet_id" widget="many2many_tags" on_change="onchange_fleet(volume, fleet_id, tonase)" colspan='2'/>
                                            <field name='volume'/>
                                            <field name='tonase'/>
                                            <field name="moq_m3"/>
                                            <field name="moq_kg"/>
                                        </tree>
                                    </field>
                                </div>
                            </group>
                        </group>
                        <!-- Here -->
                        <separator string="Week 2"/>
                        <label for='view_w2'/><field name='view_w2'/>
                        <group attrs="{'invisible':[('view_w2', '=', False)]}">
                            <group col="7">
                                <label for="r2"/>
                                <label for="r2e"/>
                                <label for="percent_r2"/>
                                <label for="qr2" invisible="1"/>
                                <label for="volume_r2"/>
                                <label for="weight_r2"/>
                                <!-- <label for="fleet_id"/> -->
                                <label for="no_vehicle"/>
                                <div><field name='r2' /></div>
                                <div><field name='r2e' /></div>
                                <div><field name='percent_r2' on_change="onchange_rx(percent_r2,'2',percent_r1,percent_r2,percent_r3,percent_r4,sch_ids2, order_line,qr2,volume_r2,weight_r2)"/></div>
                                <div invisible="1"><field name='qr2'/></div>
                                <div><field name='volume_r2'/></div>
                                <div><field name='weight_r2'/></div>
                                <div><field name='no_vehicle2' /></div>
                            </group>
                            <group/>
                            <group>
                                <div >
                                    <field name="sch_ids2" view_mode="tree">
                                        <tree editable="button" colors="blue:'cukup' not in [moq_m32]"> <!-- bds kg, in [moq_kg] -->
                                            <field name="name2" on_change="onchange_name(name2, name2s, alias2, parent.sch_ids2, parent.r2, parent.r2e)"/>
                                            <field name="name2s"/>
                                            <field name="alias2"/>
                                            <field name="p2" on_change="onchange_percent(p2, alias2, parent.percent_r2, parent.order_line)"/>
                                            <field name="vol2"/>
                                            <field name='wgt2'/>
                                            <field name="fleet_id2" widget="many2many_tags" on_change="onchange_fleet(volume2, fleet_id2, tonase2)" colspan='2'/>
                                            <field name='volume2'/>
                                            <field name='tonase2'/>
                                            <field name="moq_m32"/>
                                            <field name="moq_kg2"/>
                                        </tree>
                                    </field>
                                </div>
                            </group>
                        </group>
                         <!-- Here -->
                        <separator string="Week 3"/>
                        <label for='view_w3'/><field name='view_w3'/>
                        <group attrs="{'invisible':[('view_w3', '=', False)]}">
                            <group col="7">
                                <label for="r3"/>
                                <label for="r3e"/>
                                <label for="percent_r3"/>
                                <label for="qr3" invisible="1"/>
                                <label for="volume_r3"/>
                                <label for="weight_r3"/>
                                <!-- <label for="fleet_id"/> -->
                                <label for="no_vehicle"/>
                                <div><field name='r3' /></div>
                                <div><field name='r3e' /></div>
                                <div><field name='percent_r3' on_change="onchange_rx(percent_r3,'3',percent_r1,percent_r2,percent_r3,percent_r4,sch_ids3, order_line,qr3,volume_r3,weight_r3)"/></div>
                                <div invisible="1"><field name='qr3'/></div>
                                <div><field name='volume_r3'/></div>
                                <div><field name='weight_r3'/></div>
                                <div><field name='no_vehicle3' /></div>
                            </group>
                            <group/>
                            <group>
                                <div >
                                    <field name="sch_ids3" view_mode="tree">
                                        <tree editable="button" colors="blue:'cukup' not in [moq_m33]"> <!-- bds kg, in [moq_kg] -->
                                            <field name="name3" on_change="onchange_name(name3, name3s, alias3, parent.sch_ids3, parent.r3, parent.r3e)"/>
                                            <field name="name3s"/>
                                            <field name="alias3"/>
                                            <field name="p3" on_change="onchange_percent(p3, alias3, parent.percent_r3, parent.order_line)"/>
                                            <field name="vol3"/>
                                            <field name='wgt3'/>
                                            <field name="fleet_id3" widget="many2many_tags" on_change="onchange_fleet(volume3, fleet_id3, tonase3)" colspan='2'/>
                                            <field name='volume3'/>
                                            <field name='tonase3'/>
                                            <field name="moq_m33"/>
                                            <field name="moq_kg3"/>
                                        </tree>
                                    </field>
                                </div>
                            </group>
                        </group>
                        
                        <separator string="Week 4"/>
                        <label for='view_w4'/><field name='view_w4'/>
                        <group attrs="{'invisible':[('view_w4', '=', False)]}">
                            <group col="7">
                                <label for="r4"/>
                                <label for="r4e"/>
                                <label for="percent_r4"/>
                                <label for="qr4" invisible="1"/>
                                <label for="volume_r4"/>
                                <label for="weight_r4"/>
                                <!-- <label for="fleet_id"/> -->
                                <label for="no_vehicle"/>
                                <div><field name='r4' /></div>
                                <div><field name='r4e' /></div>
                                <div><field name='percent_r4' on_change="onchange_rx(percent_r4,'4',percent_r1,percent_r2,percent_r3,percent_r4,sch_ids4, order_line,qr4,volume_r4,weight_r4)"/></div>
                                <div invisible="1"><field name='qr4'/></div>
                                <div><field name='volume_r4'/></div>
                                <div><field name='weight_r4'/></div>
                                <div><field name='no_vehicle4' /></div>
                            </group>
                            <group/>
                            <group>
                                <div >
                                    <field name="sch_ids4" view_mode="tree">
                                        <tree editable="button" colors="blue:'cukup' not in [moq_m34]"> <!-- bds kg, in [moq_kg] -->
                                            <field name="name4" on_change="onchange_name(name4, name4s, alias4, parent.sch_ids4, parent.r4, parent.r4e)"/>
                                            <field name="name4s"/>
                                            <field name="alias4"/>
                                            <field name="p4" on_change="onchange_percent(p4, alias4, parent.percent_r4, parent.order_line)"/>
                                            <field name="vol4"/>
                                            <field name='wgt4'/>
                                            <field name="fleet_id4" widget="many2many_tags" on_change="onchange_fleet(volume4, fleet_id4, tonase4)" colspan='2'/>
                                            <field name='volume4'/>
                                            <field name='tonase4'/>
                                            <field name="moq_m34"/>
                                            <field name="moq_kg4"/>
                                        </tree>
                                    </field>
                                </div>
                            </group>
                        </group>
                        <group >
                            <group string="Total">
                                <field name="volume_tot" class="oe_subtotal_footer_separator"/>
                                <field name="weight_tot" class="oe_subtotal_footer_separator"/>
                            </group>
                        </group>

                        <notebook>
                            <page string="Purchase Order">
                                <field name="order_line" on_change="onchange_lines(volume_tot, weight_tot, order_line)" context="{'sch_ids1':sch_ids1}" string="A">
                                    <tree string="Purchase Order Lines" editable="botom">
                                        <field name="int_code" string="Code" readonly="1"/>
                                        <field name="barcode" string="Barcode" readonly="1"/>
                                        <field name="product_id" on_change="onchange_product_id(parent.pricelist_id,product_id,0,product_uom,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,name,price_unit,context)" invisible="1"/>
                                        <field name="name" readonly="1"/>
                                        <field name="date_planned" readonly="1" invisible="1"/>
                                        <field name="company_id" groups="base.group_multi_company" widget="selection"/>
                                        <field name="account_analytic_id" groups="purchase.group_analytic_accounting" domain="[('type','not in',('view','template'))]"/>
                                        <field name="suggested_order" string="Suggest"/>                    
                                        <field name="adjustment" on_change="onchange_line(product_id, adjustment, suggested_order, product_uom, price_unit,parent.volume_tot,parent.weight_tot,stock_current,in_transit,sales_3m,stock_cover,prod_weight,prod_volume,forecastMT,forecastGT, bufMT, bufGT)"/>
                                        <field name="product_qty" on_change="onchange_product_id(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id,parent.date_order,parent.fiscal_position,date_planned,name,price_unit,context)"/>
                                        <field name="product_uom" string="Unit" groups="product.group_uom" on_change="onchange_product_uom(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,name,price_unit,context)" readonly="1"/>
                                        <field name="price_unit" readonly="0"/>
                                        <field name="taxes_id" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','!=','sale')]" invisible="1"/>
                                        <field name="price_subtotal"/>                
                                        <field name="prod_weight" />             
                                        <field name="prod_volume" />
                                        <field name="avgMT"  string="Average MT" readonly="1"/>
                                        <field name="avgGT" string="Average GT" readonly="1"/>
                                        <field name="forecastMT" on_change="onchange_line(product_id, adjustment, suggested_order, product_uom, price_unit,parent.volume_tot,parent.weight_tot,stock_current,in_transit,sales_3m,stock_cover,prod_weight,prod_volume,forecastMT,forecastGT, bufMT, bufGT)"/>
                                        <field name="forecastGT" on_change="onchange_line(product_id, adjustment, suggested_order, product_uom, price_unit,parent.volume_tot,parent.weight_tot,stock_current,in_transit,sales_3m,stock_cover,prod_weight,prod_volume,forecastMT,forecastGT, bufMT, bufGT)"/>
                                        <field name="bufMT" readonly="1"/>
                                        <field name="bufGT" readonly="1"/>
                                        <field name="sales_3m" />                     
                                        <field name="stock_current" />                               
                                        <field name="ending_inv" />                               
                                        <field name="in_transit" />                               
                                        <field name="stock_cover"/>                

                                        <field name="w1" />      
                                        <field name="w11" attrs="{'invisible': [('w11','=', 0.00)]}" />
                                        <field name="w12" attrs="{'invisible': [('w12','=', 0.00)]}" />
                                        <field name="w13" attrs="{'invisible': [('w13','=', 0.00)]}" />
                                        <field name="w14" attrs="{'invisible': [('w14','=', 0.00)]}" />
                                        <field name="w15" attrs="{'invisible': [('w15','=', 0.00)]}" />
                                        <field name="w16" attrs="{'invisible': [('w16','=', 0.00)]}" />
                                        <field name="w2" />  
                                        <field name="w21" attrs="{'invisible': [('w21','=', 0.00)]}" />
                                        <field name="w22" attrs="{'invisible': [('w22','=', 0.00)]}" />
                                        <field name="w23" attrs="{'invisible': [('w23','=', 0.00)]}" />
                                        <field name="w24" attrs="{'invisible': [('w24','=', 0.00)]}" />
                                        <field name="w25" attrs="{'invisible': [('w25','=', 0.00)]}" />
                                        <field name="w26" attrs="{'invisible': [('w26','=', 0.00)]}" />  
                                        <field name="w3" />      
                                        <field name="w31" attrs="{'invisible': [('w31','=', 0.00)]}" />
                                        <field name="w32" attrs="{'invisible': [('w32','=', 0.00)]}" />
                                        <field name="w33" attrs="{'invisible': [('w33','=', 0.00)]}" />
                                        <field name="w34" attrs="{'invisible': [('w34','=', 0.00)]}" />
                                        <field name="w35" attrs="{'invisible': [('w35','=', 0.00)]}" />
                                        <field name="w36" attrs="{'invisible': [('w36','=', 0.00)]}" />
                                        <field name="w4" />  
                                        <field name="w41" attrs="{'invisible': [('w41','=', 0.00)]}" />
                                        <field name="w42" attrs="{'invisible': [('w42','=', 0.00)]}" />
                                        <field name="w43" attrs="{'invisible': [('w43','=', 0.00)]}" />
                                        <field name="w44" attrs="{'invisible': [('w44','=', 0.00)]}" />
                                        <field name="w45" attrs="{'invisible': [('w45','=', 0.00)]}" />
                                        <field name="w46" attrs="{'invisible': [('w46','=', 0.00)]}" />                  
                                    </tree>
                                </field>
                                <group class="oe_subtotal_footer oe_right">
                                    <field name="amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="amount_tax" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="amount_total"/>
                                        <button name="button_dummy"
                                            states="draft" string="(update)" type="object" class="oe_edit_only oe_link"/>
                                    </div>
                                    <field name="amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                                <div class="oe_clear"/>
                                <field name="notes" class="oe_inline" placeholder="Keterangan"/>
                            </page>
                            
                            <page string="User's Location">
                                <field name="location_ids" readonly="False"/>
                            </page>
                            <page string="User's Principals">
                                <field name="principal_ids" readonly="False" view_mode="tree">
                                    <tree editable="bottom">
                                        <field name='name'/>
                                        <field name='type_partner_id'/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Incoming Shipments &amp; Invoices">
                                <group>
                                    <group>
                                        <field name="dest_address_id" string="Customer Address" on_change="onchange_dest_address_id(dest_address_id)" groups="stock.group_locations"/>
                                        <field name="minimum_planned_date"/>
                                        <field name="shipped" groups="base.group_no_one"/>
                                    </group>
                                    <group>
                                        <field name="invoice_method"/>
                                        <field name="invoiced"/>
                                        <field name="payment_term_id" widget="selection"/>
                                        <field name="fiscal_position" attrs="{'readonly': [('invoiced','=', True)]}" />
                                        <field name="validator" groups="base.group_no_one"/>
                                        <field name="date_approve" groups="base.group_no_one"/>
                                    </group>
                                </group>
                            </page>
                        </notebook>

                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                    </form>
                </form>
            </field>
        </record>

    </data>
</openerp>
