<openerp>
	<data>

        <record model="ir.ui.view" id="absensi_mhs_search">
            <field name="name">Cari Absensi</field>
            <field name="model">absensi</field>
            <field name="arch" type="xml">
                <search string="Cari jadwal">
                    <group col="10" colspan="4">
                         <field name="name"/>
                         <field name="employee_id"/>
                    </group>
                    <newline/>
                    <group expand="0" string="Group By..." colspan="12" col="10">
                        <filter icon="terp-project" string="Dosen" help="By Pengajar" context="{'group_by':'employee_id'}"/>
                        <filter icon="terp-project" string="Tahun Ajaran" help="By Tahun Ajaran" context="{'group_by':'tahun_ajaran_id'}"/>
                        <filter icon="terp-project" string="Fakultas" help="By Fakultas" context="{'group_by':'fakultas_id'}"/>
                        <!-- <filter icon="terp-project" string="Jurusan" help="By Jurusan" context="{'group_by':'jurusan_id'}"/> -->
                        <filter icon="terp-project" string="Program Studi" help="By Prodi" context="{'group_by':'prodi_id'}"/>
                        <filter icon="terp-project" string="Kelas" help="By Kelas" context="{'group_by':'kelas_id'}"/>
                        <filter icon="terp-project" string="Semester" help="By Semester" context="{'group_by':'semester_id'}"/>
                        <filter icon="terp-project" string="Mata Kuliah" help="By Mata Kuliah" context="{'group_by':'mata_kuliah_id'}"/>
                        <filter icon="terp-project" string="State" help="By State" context="{'group_by':'state'}"/>
                    </group>
                </search>
            </field>
        </record>
    

        <record model="ir.ui.view" id="absensi_mhs_tree_view">
            <field name="name">absensi.tree</field>
            <field name="model">absensi</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Daftar Absensi" version="7.0">
                    <field name="name"/>
                    <field name="employee_id"/>
                    <field name="kelas_id"/>                   
                    <field name="tahun_ajaran_id"/>
                    <field name="fakultas_id"/>
                    <field name="prodi_id"/>
                    <field name="mata_kuliah_id"/>
                    <field name="state" invisible="1"/>
                    <field name="user_id" invisible="1"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="absensi_mhs_form_view">
            <field name="name">absensi.form</field>
            <field name="model">absensi</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Absensi Kuliah" version="7.0">
                    <header>
                        <button name='open_absensi' string='Confirm' states='draft' type='object' groups="vit_universities_v8.group_univ_manager_baak"/>
                        <button name='close_absensi' string='Close' states='open' type='object' groups="vit_universities_v8.group_univ_dosen"/>
                        <button name='cancel_absensi' string='Cancel' states='open' type='object' groups="vit_universities_v8.group_univ_manager_baak"/>
                                        
                        <field name="state" widget="statusbar" nolabel="1"/>
                    </header>                      
<!--                     <sheet> -->
                        <group>
                            <group>
                                <field name="name"/>
                                <field name="employee_id"/> 
                                <field name="semester_id"/>
                                <field name="user_id" invisible="1"/>
                            </group>
                            <group>
                                <field name="tahun_ajaran_id"/>
                                <field name="fakultas_id" domain="[('is_internal','=',True)]"/>
                                <field name="prodi_id" domain="[('fakultas_id','=',fakultas_id),('is_internal','=',True)]"/>
                            </group>
                        </group>
                        <group>    
                            <group>
                                <field name="mata_kuliah_id"/> 
                                <field name="sesi"/>                                                     
                            </group>
                            <group>
                                <field name="konsentrasi_id"/>
                               <field name="kelas_id" on_change="onchange_kelas(tahun_ajaran_id, fakultas_id, prodi_id,kelas_id,konsentrasi_id)" attrs="{'invisible':[('semester_id','not in',(9,10))]}"/> 
                            </group>
                        </group>
                        <button name="query_mahasiswa_by_pengajuan_krs" string="Query Mahasiswa" type="object" groups="vit_universities_v8.group_univ_staff_baak" attrs="{'invisible':['|',('semester_id','in',(9,10)),('state','!=','draft')]}"/>
                        <notebook colspan="4">

                            <page string="Absensi">
                                <field name="absensi_ids" nolabel="1" widget="one2many_list" attrs="{'readonly':[('state','=','close')]}">
                                    <tree string="Absensi" editable="bottom">
                                        <field name="partner_id"/>
                                        <field name="absensi_1"/>
                                        <field name="absensi_2"/>
                                        <field name="absensi_3"/>
                                        <field name="absensi_4"/>
                                        <field name="absensi_5"/>
                                        <field name="absensi_6"/>
                                        <field name="absensi_7"/>
                                        <field name="absensi_8"/>
                                        <field name="absensi_9"/>
                                        <field name="absensi_10"/>
                                        <field name="absensi_11"/>
                                        <field name="absensi_12"/>
                                        <field name="absensi_13"/>
                                        <field name="absensi_14"/>                              
                                        <field name="percentage"/>
                                        <field name="state" invisible="1"/>
                                    </tree>
                                </field> 
                                    <notebook>
                                     <page string="History Absensi">
                                        <field name="history_absensi_ids" nolabel="1" widget="one2many_list" attrs="{'readonly':[('state','=','close')]}">
                                            <tree string="History">
                                                <field name="absensi_id" invisible="1"/>
                                                <field name="history_absensi_1"/>
                                                <field name="history_absensi_2"/>
                                                <field name="history_absensi_3"/>
                                                <field name="history_absensi_4"/>
                                                <field name="history_absensi_5"/>
                                                <field name="history_absensi_6"/>
                                                <field name="history_absensi_7"/>
                                                <field name="history_absensi_8"/>
                                                <field name="history_absensi_9"/>
                                                <field name="history_absensi_10"/>
                                                <field name="history_absensi_11"/>
                                                <field name="history_absensi_12"/>
                                                <field name="history_absensi_13"/>
                                                <field name="history_absensi_14"/>                              
                                            </tree>
                                        </field> 
                                    </page>
                                </notebook>
                            </page>
                            <page string="Nilai">
                                <p class="oe_grey">Presentase nilai bisa di set ulang pada tab Setting</p>
                                    <p class="oe_grey">Default penilaian: Absensi(10%), Tugas(20%), UTS(30%), UAS(40%)</p>
                                <field name="absensi_nilai_ids" nolabel="1" widget="one2many_list">
                                    <tree string="Absensi" editable="bottom">
                                        <field name="partner_id"/>
                                        <field name="ulangan"/>
                                        <field name="presentasi"/>
                                        <field name="quiz"/>
                                        <field name="tugas"/>
                                        <field name="uts"/>
                                        <field name="uas"/>
                                        <field name="lainnya"/>                               
                                        <field name="state" invisible="1"/>
                                    </tree>
                                </field>        
                            </page>                            
                            <page string="Setting" groups="vit_universities_v8.group_univ_dosen">
                                <sheet>
                                    <p class="oe_grey">Setting presentase nilai ini berlaku jika jumlah (Absensi+Tugas+UTS+UAS+Ulangan+Presentasi+Quiz+Lainnya = 100 (%)</p>
                                    <p class="oe_grey">Default penilaian: Absensi(10%), Tugas(20%), UTS(30%), UAS(40%)</p>
                                    <group col='4'>
                                        <group col='1'>
                                            <label for="absensi" />
                                            <field name="absensi" nolabel="1" /> 
                                        </group>
                                        <group col='1'>
                                            <label for="tugas" />
                                            <field name="tugas" nolabel="1"/> 
                                        </group>
                                         <group col='1'>
                                             <label for="uts" />
                                             <field name="uts"  nolabel="1"/> 
                                        </group>
                                        <group col='1'>
                                            <label for="uas" />
                                            <field name="uas" nolabel="1"/> 
                                        </group>
                                    </group>
                                    <group col='4'>
                                        <group col='1'>
                                            <label for="ulangan" />
                                            <field name="ulangan" nolabel="1" /> 
                                        </group>
                                        <group col='1'>
                                            <label for="presentasi" />
                                            <field name="presentasi" nolabel="1"/> 
                                        </group>
                                         <group col='1'>
                                             <label for="quiz" />
                                             <field name="quiz"  nolabel="1"/> 
                                        </group>
                                        <group col='1'>
                                            <label for="lainnya" />
                                            <field name="lainnya" nolabel="1"/> 
                                        </group>
                                    </group>
                                </sheet>                                
                            </page>        
                        </notebook>
<!--                     </sheet>    -->
                </form>
            </field>
        </record>
        


        <record model="ir.actions.act_window" id="absensi_mhs_list_action">
            <field name="name">Absensi dan Nilai</field>
            <field name="res_model">absensi</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="absensi_mhs_search"/>
            <field name="view_id" ref="absensi_mhs_tree_view"/>                      
            <field name="help" type="html">
            <p class="oe_view_nocontent_create">Klik tombol Create untuk membuat data absensi.</p><p>disini belum ada data tentang absensi !</p></field>
        </record>


            <menuitem id="master_absensi" name="Absensi dan Nilai" parent="vit_universities_v8.master_data_kbm" action="absensi_mhs_list_action" sequence="30"/>

        <!--sequance-->
        <record forcecreate="1" id="seq_type_absensi_mhs" model="ir.sequence.type">
            <field name="name">Absensi</field>
            <field name="code">absensi</field>
        </record>
        
        <record  forcecreate="1" id="seq_absensi_mhs" model="ir.sequence">
            <field name="name">Absensi</field>
            <field name="code">absensi</field>
            <field name="prefix">%(y)s/</field>
            <field name="padding">5</field>
        </record> 

	</data>
</openerp>	