<openerp>
<data>
<!-- LO Confirmation -->

<template id="vit_claim_web.loc">
	<h2>Letter of Confirmation</h2>  

	<h3>Benefit <t t-esc="member_plan.plan_schedule_id.product_plan_id.product_plan_base_id.name"/> - <t t-esc="member_plan.plan_schedule_id.product_plan_id.product_plan_base_id.pplan"/> </h3>

	<form t-attf-action="/claim/discharge_process" method="post" class="form-horizontal mt32" enctype="multipart/form-data">


        <!-- loo for each claim details -->
        <t t-foreach="claim.claim_detail_ids" t-as="detail">
         	<div class="row">
            	<div class="col-md-4 col-sm-4">
                    <label class="control-label"><t t-esc="detail.benefit_id.name"/></label>
                </div>
                <div class="col-md-4 col-sm-4">
                   	<input type="text" t-attf-name="claim_details.{{detail.id}}" 
                        t-attf-value="{{detail.billed}}"/>
                </div>
            </div>
        </t>

        <!-- diagnosis -->
        <div class="row">
            <div class="col-md-4 col-sm-4">
                <label class="control-label">Diagnosis</label>
            </div>
            <div class="col-md-4 col-sm-4">
                <input type="text" class="form-control" name="diagnose_name" id="diagnose_name"/>
            </div>
        </div>

        <!-- 2nd diagnosis -->
        <div class="row">
            <div class="col-md-4 col-sm-4">
                <label class="control-label">2nd Diagnosis</label>
            </div>
            <div class="col-md-4 col-sm-4">
                <input type="text" class="form-control" name="2nd_diagnosis_name" id="2nd_diagnosis_name"/>
            </div>
        </div>

        <!-- diagnosis -->
        <div class="row">
            <div class="col-md-4 col-sm-4">
                <label class="control-label">3rd Diagnosis</label>
            </div>
            <div class="col-md-4 col-sm-4">
                <input type="text" class="form-control" name="3rd_diagnosis_name" id="3rd_diagnosis_name"/>
            </div>
        </div>

        <script src="/vit_claim_web/static/src/js/jquery-ui/jquery.js"></script>
        <script src="/vit_claim_web/static/src/js/jquery-ui/jquery-ui.js"></script>
        <script src="/vit_claim_web/static/src/js/jquery-ui/jquery.ui.autocomplete.html.js"></script>
        <!-- value : result, label : popup -->
        <script type='text/javascript'>
            var Diagnoses = []
            <t t-foreach="diagnosis or []" t-as="diag">
                Diagnoses.push({"id":"<t t-esc="diag.id"/>",
                                "label":"<t t-esc="diag.id"/> <t t-esc="diag.name"/>",
                                "value":"<t t-esc="diag.diagnosis"/> <t t-esc="diag.name"/>"});
            </t>
            Diagnoses = Diagnoses.sort();
            $( "#diagnose_name" ).autocomplete({
                source: Diagnoses,
                minLength: 2,
                select: function(event, ui){
                    console.log("ui.item : ",ui.item);
                    $("#diagnosis_id").val(ui.item.id);
                },
                html:true,
            });
            $( "#2nd_diagnosis_name" ).autocomplete({
                source: Diagnoses,
                minLength: 2,
                select: function(event, ui){
                    console.log("ui.item : ",ui.item);
                    $("#2nd_diagnosis").val(ui.item.id);
                },
                html:true,
            });
            $( "#3rd_diagnosis_name" ).autocomplete({
                source: Diagnoses,
                minLength: 2,
                select: function(event, ui){
                    console.log("ui.item : ",ui.item);
                    $("#3rd_diagnosis").val(ui.item.id);
                },
                html:true,
            });
        </script>
    
        <!-- buttons -->
        <div class="row">
            <div class="col-sm-8 col-md-7">
                <button type="submit" name="confirm" class="btn btn-primary">
                    Confirm
                </button>
                <button type="submit" name="email"  class="btn btn-warning">
                    Email
                </button>
                <button type="submit" name="print"  class="btn btn-danger">
                    Print
                </button>
            </div>
        </div> 

	    <input type="hidden" name="claim_id" t-attf-value="{{ claim.id }}" />
	    <input type="hidden" name="member_id" t-attf-value="{{ member.id }}" />
        <input type="hidden" name="member_plan_id" t-attf-value="{{ member_plan.id }}" />
        <input type="hidden" name="diagnosis_id" id="diagnosis_id"/>
        <input type="hidden" name="2nd_diagnosis" id="2nd_diagnosis"/>
        <input type="hidden" name="3rd_diagnosis" id="3rd_diagnosis"/>

	</form>
</template>

<!-- discharge -->

<template id="vit_claim_web.discharge_confirmation" name="Discharge Confirmation" page="True">
    <t t-call="website.layout">
        <t t-set="title">Discharge Confirmation</t>
        <div class="container">

            <h3>Claim No: <t t-esc="claim.claim_no" /> </h3>
            <t t-call="vit_claim_web.patient_data" />
            <t t-call="vit_claim_web.loc" />

        </div>
        <br/>
    </t>	
</template>



</data>
</openerp>